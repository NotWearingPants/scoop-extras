{
    "version": "5.0",
    "homepage": "https://boltbait.com/pdn/",
    "description": "Collection of paint.net plugins by BoltBait",
    "depends": "paint.net",
    "url": "https://boltbait.com/pdn/BoltBaitPack50.zip",
    "hash": "cc11b9b95d3033b582f4994071479430f4758c9fe403b3ca62b63e31f6514735",
    "pre_install": [
        "$installerAssembly = [System.Reflection.Assembly]::Load([IO.File]::ReadAllBytes(\"$dir\\BoltBaitPackInstall50.exe\"))",
        "Remove-Item \"$dir\\BoltBaitPackInstall50.exe\"",
        "$pluginResourcePrefix = 'Install.Attachments.'",
        "$pluginsResourceNames = $installerAssembly.GetManifestResourceNames() | Where-Object { $_.StartsWith($pluginResourcePrefix) -and $_.EndsWith('.dll') }",
        "$pluginFolder = Join-Path (appdir 'paint.net' $global) 'current\\Effects'",
        "$pluginsResourceNames | ForEach-Object {",
        "    $pluginFileName = $_.Replace($pluginResourcePrefix, '')",
        "    $installerAssembly.GetManifestResourceStream($_).",
        "        CopyTo([IO.File]::OpenWrite(",
        "            (Join-Path \"$pluginFolder\" \"$pluginFileName\")",
        "        ))",
        "}",
        "$pluginsResourceNames.Replace($pluginResourcePrefix, '') | Out-File \"$dir\\plugins.txt\" -Encoding Ascii"
    ],
    "uninstaller": {
        "script": [
            "$pluginFolder = Join-Path (appdir 'paint.net' $global) 'current\\Effects'",
            "Get-Content \"$dir\\plugins.txt\" | Remove-Item -Path { Join-Path \"$pluginFolder\" \"$_\" } -ErrorAction SilentlyContinue"
        ]
    }
}
